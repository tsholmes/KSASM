.ifndef libdevice { .macro libdevice
.ns device.

.macro define(id, fields) {
  data:
    fields
  data.end:
  .macro init devmap (..addns(data), ..addns(data.end)-..addns(data), id, 0)
}

.endns
}